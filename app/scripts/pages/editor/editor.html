<div class="ui segments editorpage">
  <div class="ui horizontal segments" data-bind="visible: !isOld()">
    <div class="ui segment">
        <i class="clock icon"></i>
        <span style="font-weight:bold">Time left:</span>
        <span data-bind="text: timeLeft"></span>
    </div>
    <div class="ui segment">
      <!-- ko if: connected -->
        <!-- ko if: saved -->
          <i class="save icon"></i>
          Your solution is saved automatically as you type.
        <!-- /ko -->
        <!-- ko ifnot: saved -->
          <i class="wait icon"></i>
          Saving&hellip;
        <!-- /ko -->
      <!-- /ko -->
      <!-- ko ifnot: connected -->
        <i class="red warning icon"></i>
        You are disconnected. Changes cannot be saved right now.
      <!-- /ko -->
    </div>
  </div>
  <div class="ui segment editor" data-bind="template: { afterRender: init }">
    <div class="ui fluid">
      <!-- ko ifnot: exerciseNotFound -->
        <div class="ui grid">
          <!-- ko ifnot: isOld -->
          <div class="eight wide column">
            <div class="ui header">Exercise <span data-bind="text: title"></span></div>
          </div>
          <!-- /ko -->
          <!-- ko if: isOld -->
            <div class="four wide column" />
          <!-- /ko -->
          <div class="eight wide column">
            <div class="ui header">Preview</div>
          </div>
        </div>
        <!-- ko foreach: tasks -->
          <!-- ko ifnot: $parent.isOld -->
          <div class="ui grid" data-bind="attr: {'id': 'task-' + $index()}, template: { afterRender: $parent.initTask.bind(null, $data, $element)}">
            <div class="eight wide column exerciseEditor">
              <div class="task">
                <span class="task">
                  Task <span data-bind="text: $data.number()"></span>
                  <!--ko if: $data.hasTitle --> &ndash; <span data-bind="text: $data.title()"></span><!-- /ko -->
                  <span class="points">(<span data-bind="text: $data.maxPoints()"></span> points)</span>
                </span><br/>
                <div class="description" data-bind="attr: {'id': 'text-' + $data.number()}"></div>
              </div>
              <div class="ui horizontal divider">
                Ihre Lösung
              </div>
              <div data-bind="attr: {'id': 'editor-' + $data.number()}"></div>
            </div>
            <div class="eight wide column exercisePreview">
              <div class="task">
                <span class="task">
                  Task <span data-bind="text: $data.number()"></span>
                  <!--ko if: $data.hasTitle --> &ndash; <span data-bind="text: $data.title()"></span><!-- /ko -->
                  <span class="points">(<span data-bind="text: $data.maxPoints()"></span> points)</span>
                </span><br/>
                <div class="description" data-bind="attr: {'id': 'text-sol-' + $data.number()}"></div>
              </div>
              <div class="ui horizontal divider">
                Ihre Lösung
              </div>
              <div data-bind="attr: {'id': 'preview-' + $data.number()}"></div>
            </div>
          </div>
          <!-- /ko -->
          <!-- ko if: $parent.isOld -->
          <div class="ui grid" data-bind="attr: {'id': 'task-' + $data.number()}, template: { afterRender: $parent.initTask.bind(null, $data, $element)}">
            <div class="four wide column" />
            <div class="eight wide column exercisePreview">
              <div class="task">
                <span class="task">
                  Task <span data-bind="text: $data.number()"></span>
                  <!--ko if: $data.hasTitle --> &ndash; <span data-bind="text: $data.title()"></span><!-- /ko -->
                  <span class="points">(<span data-bind="text: $data.maxPoints()"></span> points)</span>
                </span><br/>
                <span class="description" data-bind="text: $data.text()"></span>
              </div>
              <div data-bind="attr: {'id': 'preview-' + $index}"></div>
            </div>
          </div>
          <!-- /ko -->
        <!-- /ko -->

        <div class="bar">
          <div class="column" id="showtests">
            <!-- ko if: tests().length > 0 && failedTests().length == 0 -->
                <i class="green thumbs up icon"></i>
                <!-- ko if: selectedTask() -->
                  Your solution for Task <span data-bind="text: selectedTask().number"></span> looks good.
                <!-- /ko -->
                <!-- ko ifnot: selectedTask() -->
                  Your solution looks good.
                <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: tests().length > 0 && failedTests().length > 0 -->
              <i class="orange meh icon"></i>
              <!-- ko if: selectedTask() -->
                Your should review your solution for Task <span data-bind="text: selectedTask().number"></span>.
              <!-- /ko -->
              <!-- ko ifnot: selectedTask() -->
                You should review your solution.
              <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: tests().length == 0 -->
              <i class="info icon"></i>
              Write some tests to automatically check if your solution looks good.
            <!-- /ko -->
          </div>
          <div class="ui flowing popup top left transition hidden">
            <!-- ko if: selectedTask() -->
              <div class="ui list" data-bind="foreach: tests">
                <div class="item">
                  <i class="green checkmark icon" data-bind="visible: passes"></i>
                  <i class="red remove icon" data-bind="visible: !passes"></i>
                  <div class="content" data-bind="text: name"></div>
                </div>
              </div>
              <!-- ko if: tests().length == 0 -->
                <em>There are no tests.</em>
              <!-- /ko -->
            <!-- /ko -->
            <!-- ko ifnot: selectedTask() -->
              <div class="ui list" data-bind="foreach: allTests">
                <div class="item">
                  <div class="header">Task <span data-bind="text: $parent.tasks()[$index()].number"></span>:</div>
                </div>
                <!-- ko if: $data.length == 0 -->
                  <em>There are no tests for this task.</em>
                <!-- /ko -->
                <!-- ko foreach: $data -->
                <div class="item">
                  <i class="green checkmark icon" data-bind="visible: passes"></i>
                  <i class="red remove icon" data-bind="visible: !passes"></i>
                  <div class="content" data-bind="text: name"></div>
                </div>
                <!-- /ko -->
              </div>
            <!-- /ko -->
          </div>
        </div>
      <!-- /ko -->
      <!-- ko if: exerciseNotFound -->
        <div class="ui warning icon message">
          <i class="frown icon"></i>
          <div class="content">
            <div class="header">Unknown exercise.</div>
            <p>
              The exercise you requested could not be found. Please go back to the <a href="#overview">overview page</a>
              and select one that exists.
            </p>
          </div>
        </div>
      <!-- /ko -->
    </div>
  </div>
</div>
